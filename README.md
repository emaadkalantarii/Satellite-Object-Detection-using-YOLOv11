# Satellite Object Detection with YOLOv11

This project implements a computer vision solution for detecting and classifying satellite objects in images using the YOLOv11 model.  It includes data preprocessing, model training, and inference for generating object detection results.

## Project Structure

The repository contains the following key files:

* **`yolo_stream_m_35.py`**:  This script handles data preparation, including organizing images and converting annotations into the YOLO format, and trains the YOLOv11 model.
* **`Submissioncode.py`**: This script loads the trained YOLOv11 model, performs inference on test images, and generates a submission CSV file with object detections.
* **`data.yaml`**:  This YAML file configures the dataset paths and class names for YOLO training.
* **`dataset/`**: (Assumed directory - the scripts reference this) This directory should contain the image data and CSV label files, organized as follows:
    * `train/`:  Directory containing training images and a `labels/` subdirectory with YOLO format text files.
    * `val/`:    Directory containing validation images and a `labels/` subdirectory with YOLO format text files.
    * `test/`:   Directory containing test images.
    * `labels/`:  Directory containing `train.csv` and `val.csv` annotation files.
* `runs/`: (Generated by `yolo_stream_m_35.py`)  This directory will contain the trained model and training logs.
* `yolo11m.pt`: (Assumed YOLOv11 pre-trained weights) Pre-trained YOLOv11 model weights.

## Dependencies

The project relies on the following Python libraries:

* `os`
* `pandas`
* `numpy`
* `shutil`
* `cv2` (OpenCV)
* `random`
* `albumentations`
* `ultralytics` (YOLOv8, but the code mentions YOLOv11)
* `csv`
* `PIL` (Python Imaging Library)
* `torch`

It is recommended to install these dependencies using `pip`:

```bash
pip install pandas numpy opencv-python albumentations ultralytics pillow torch
```

## Data Preparation
The yolo_stream_m_35.py script performs the following data preparation steps:

1. Directory Restructuring: Moves images from class-specific subdirectories into dataset/train/images/ and dataset/val/images/, creating dataset/train/labels/ and dataset/val/labels/ for YOLO-formatted labels.
2. Label Conversion: Reads bounding box annotations from train.csv and val.csv and converts them into YOLO format (<class_id> <x_center> <y_center> <width> <height>), saving each image's label in a corresponding .txt file within the labels/ directories.
The script normalizes bounding box coordinates to be relative to the image size (1024x1024).
It uses a class_number_pairs dictionary to map class names to numerical IDs.
The data.yaml file defines the dataset structure for YOLO training, specifying the paths to the training and validation sets, the number of classes (nc), and the class names.

## Model Training
The yolo_stream_m_35.py script trains the YOLOv11 model using the prepared data.  The training process is configured with parameters such as:

epochs: Number of training epochs.
imgsz: Image size used for training.
batch: Batch size.
optimizer: Optimization algorithm.
lr0: Initial learning rate.
weight_decay: Weight decay for regularization.
patience: Early stopping patience.
augment: Data augmentation.
device: Training device (CPU or GPU).
The trained model and training logs are saved in the runs/ directory.

## Inference and Submission
The Submissioncode.py script performs object detection on the test images located in the dataset/test/ directory.

1. Model Loading: Loads the trained YOLOv11 model.
2.Inference: Iterates through each image in the test directory, performs inference to detect objects, and extracts bounding boxes and class predictions.
3. Result Formatting: Formats the detection results and writes them to a CSV file (submission.csv) with columns: filename, class, and bbox (in the format x1,y1,x2,y2).
4. Error Handling: Includes error handling to ensure the script continues to process images even if errors occur.

## Usage
1. Data Setup:  Organize your image data and annotation CSV files according to the structure described above. Ensure the paths in data.yaml, yolo_stream_m_35.py, and Submissioncode.py are correct.

2. Training:  Run yolo_stream_m_35.py to preprocess the data and train the YOLOv11 model:
```bash
python yolo_stream_m_35.py
```

3. Inference:  Run Submissioncode.py to generate the submission CSV file:
```bash
python Submissioncode.py
```
The submission.csv file will be created in the dataset/ directory.
